!function(){"use strict";const t={2025:{cutoffMonth:8,exceptions:{},maxGrade:12},2026:{cutoffMonth:8,exceptions:{},maxGrade:12}},e={"Pre-Primary":["IB","Waldorf","Montessori"],"1-3":["IB","Waldorf","Montessori"],4:t=>2026===t?["IB","Waldorf","Montessori"]:["IB","Waldorf"],"5-7":t=>["IB","Waldorf"],8:t=>["IB","Waldorf"],"9-10":t=>["IB","IB E&T"],11:t=>["IB DP"],12:t=>["IB CP"]};const n={IB:"/ib","IB DP":"/ib","IB CP":"/ib","IB E&T":"/ib",Waldorf:"/waldorf",Montessori:"/montessori"};function r(){const r=document.getElementById("gradecalc-dob");if(!r||!r.value)return;const o=new Date(r.value);[2025,2026].forEach(r=>{const a=function(e,n){const r=e.getFullYear(),o=e.getMonth()+1,a=t[n];if(a.exceptions[r]&&o>a.exceptions[r].afterMonth)return`Grade ${a.exceptions[r].grade}`;const c=n-r-(o>a.cutoffMonth?1:0);if(c>=3&&c<=5)return`Pre-Primary (${c} y.o.)`;if(c>=6){const t=c-5;return t<=a.maxGrade?`Grade ${t}`:"—"}return"—"}(o,r),c=function(t,n){if("—"===t)return"—";const r=t.match(/Pre-Primary|Grade (\d+)/);if(!r)return"—";const[o,a]=r;if(!a)return e["Pre-Primary"].join(", ");let c;c=a>=11?a.toString():Object.keys(e).find(t=>{const[e,n]=t.split("-").map(Number);return a>=e&&a<=(n||e)});const i=c?"function"==typeof e[c]?e[c](n):e[c]:null;return a>=11?["IB DP","IB CP"].join(", "):i?.join(", ")||"—"}(a,r),i=document.getElementById(`grade${r}`),d=document.getElementById(`program${r}`);var l;i&&(i.textContent=a),d&&(d.innerHTML="—"===(l=c)?"—":l.split(/\s*,\s*/).map(t=>`<a href="${n[t]||"#"}" class="program-link" target="_blank" rel="noopener">${t}</a>`).join(" "))})}function o(){document.body.addEventListener("click",t=>{if(t.target.closest('a[href="#popup:gradecalc"]')){const t=document.querySelector('input[name="DOB"]'),e=document.getElementById("gradecalc-dob");t&&e&&(e.value=function(t){const e=t.replace(/-/g,"/").split("/");if(3===e.length){const t=e[0].padStart(2,"0"),n=e[1].padStart(2,"0");return`${e[2]}-${n}-${t}`}return t}(t.value),e._flatpickr&&e._flatpickr.setDate(e.value),r())}});const t=document.getElementById("gradecalc-dob");t&&("undefined"!=typeof flatpickr?flatpickr(t,{dateFormat:"Y-m-d",altInput:!0,altFormat:"d / m / Y",minDate:"2007-01-01",maxDate:"2023-12-31",defaultDate:t.value||"2008-09-01",disableMobile:!1,onChange:function(){r()}}):t.addEventListener("change",r),r())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),window.GradeCalculator={init:o,updateGrades:r}}();