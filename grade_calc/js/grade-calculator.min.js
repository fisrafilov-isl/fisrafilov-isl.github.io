!function(){"use strict";let e={2024:{cutoffMonth:8,exceptions:{2014:{afterMonth:10,grade:4},2015:{afterMonth:8,grade:3}},maxGrade:11},2025:{cutoffMonth:8,exceptions:{2014:{afterMonth:8,grade:5}},maxGrade:12}},t={"Pre-Primary":["IB","Waldorf","Montessori"],"1-3":["IB","Waldorf","Montessori"],4:e=>["IB","Waldorf"],"5-7":e=>["IB","Waldorf"],8:e=>2024===e?["IB"]:["IB","Waldorf"],"9-10":e=>2024===e?["IB"]:["IB","IB E&T"],11:e=>["IB DP"],12:e=>["IB CP"]},r={IB:"/ib","IB DP":"/ib","IB CP":"/ib","IB E&T":"/ib",Waldorf:"/waldorf",Montessori:"/montessori"};function n(){let n=document.getElementById("gradecalc-dob");if(!n||!n.value)return;let a=new Date(n.value);[2024,2025].forEach(n=>{let o=function t(r,n){let a=r.getFullYear(),o=r.getMonth()+1,l=e[n];if(l.exceptions[a]&&o>l.exceptions[a].afterMonth)return`Grade ${l.exceptions[a].grade}`;let i=n-a-(o>l.cutoffMonth?1:0);if(i>=3&&i<=5)return`Pre-Primary (${i} y.o.)`;if(i>=6){let d=i-5;return d<=l.maxGrade?`Grade ${d}`:"—"}return"—"}(a,n),l=function e(r,n){if("—"===r)return"—";let a=r.match(/Pre-Primary|Grade (\d+)/);if(!a)return"—";let[o,l]=a;if(!l)return t["Pre-Primary"].join(", ");let i;i=l>=11?l.toString():Object.keys(t).find(e=>{let[t,r]=e.split("-").map(Number);return l>=t&&l<=(r||t)});let d=i?"function"==typeof t[i]?t[i](n):t[i]:null;return 2025===n&&l>=11?"IB DP, IB CP":d?.join(", ")||"—"}(o,n),i=document.getElementById(`grade${n}`),d=document.getElementById(`program${n}`);if(i&&(i.textContent=o),d){var f;d.innerHTML="—"===(f=l)?"—":f.split(/\s*,\s*/).map(e=>{let t=r[e]||"#";return`<a href="${t}" class="program-link" target="_blank" rel="noopener">${e}</a>`}).join(" ")}})}function a(){document.body.addEventListener("click",e=>{if(e.target.closest('a[href="#popup:gradecalc"]')){let t=document.querySelector('input[name="DOB"]'),r=document.getElementById("gradecalc-dob");t&&r&&(r.value=function e(t){let r=t.replace(/-/g,"/").split("/");if(3===r.length){let n=r[0].padStart(2,"0"),a=r[1].padStart(2,"0"),o=r[2];return`${o}-${a}-${n}`}return t}(t.value),n())}});let e=document.getElementById("gradecalc-dob");e&&(e.addEventListener("change",n),n())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a(),window.GradeCalculator={init:a,updateGrades:n}}();