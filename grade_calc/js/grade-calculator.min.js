!function(){"use strict";const e={2025:{cutoffMonth:8,exceptions:{},maxGrade:12},2026:{cutoffMonth:8,exceptions:{},maxGrade:12}},t={"Pre-Primary":["IB","Waldorf","Montessori"],"1-3":["IB","Waldorf","Montessori"],4:e=>2026===e?["IB","Waldorf","Montessori"]:["IB","Waldorf"],"5-7":e=>["IB","Waldorf"],8:e=>["IB","Waldorf"],"9-10":e=>["IB","IB E&T"],11:e=>["IB DP"],12:e=>["IB CP"]};const n={IB:"/ib","IB DP":"/ib","IB CP":"/ib","IB E&T":"/ib",Waldorf:"/waldorf",Montessori:"/montessori"};function r(){const r=document.getElementById("gradecalc-dob");if(!r||!r.value)return;const o=new Date(r.value);[2025,2026].forEach(r=>{const a=function(t,n){const r=t.getFullYear(),o=t.getMonth()+1,a=e[n];if(a.exceptions[r]&&o>a.exceptions[r].afterMonth)return`Grade ${a.exceptions[r].grade}`;const c=n-r-(o>a.cutoffMonth?1:0);if(c>=3&&c<=5)return`Pre-Primary (${c} y.o.)`;if(c>=6){const e=c-5;return e<=a.maxGrade?`Grade ${e}`:"—"}return"—"}(o,r),c=function(e,n){if("—"===e)return"—";const r=e.match(/Pre-Primary|Grade (\d+)/);if(!r)return"—";const[o,a]=r;if(!a)return t["Pre-Primary"].join(", ");let c;c=a>=11?a.toString():Object.keys(t).find(e=>{const[t,n]=e.split("-").map(Number);return a>=t&&a<=(n||t)});const d=c?"function"==typeof t[c]?t[c](n):t[c]:null;return a>=11?["IB DP","IB CP"].join(", "):d?.join(", ")||"—"}(a,r),d=document.getElementById(`grade${r}`),i=document.getElementById(`program${r}`);var s;d&&(d.textContent=a),i&&(i.innerHTML="—"===(s=c)?"—":s.split(/\s*,\s*/).map(e=>`<a href="${n[e]||"#"}" class="program-link" target="_blank" rel="noopener">${e}</a>`).join(" "))})}function o(){document.body.addEventListener("click",e=>{if(e.target.closest('a[href="#popup:gradecalc"]')){const e=document.querySelector('input[name="DOB"]'),t=document.getElementById("gradecalc-dob");e&&t&&(t.value=function(e){const t=e.replace(/-/g,"/").split("/");if(3===t.length){const e=t[0].padStart(2,"0"),n=t[1].padStart(2,"0");return`${t[2]}-${n}-${e}`}return e}(e.value),r())}});const e=document.getElementById("gradecalc-dob");e&&(e.addEventListener("change",r),r())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),window.GradeCalculator={init:o,updateGrades:r}}();