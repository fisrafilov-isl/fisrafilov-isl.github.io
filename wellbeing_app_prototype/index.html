<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wellbeing Mentor Tracker - ISL Demo</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icon Components
        const Icon = ({ name, ...props }) => {
            const ref = React.useRef(null);

            React.useEffect(() => {
                if (ref.current) {
                    lucide.createElement(lucide[name]).outerHTML;
                    const icon = lucide.createElement(lucide[name]);
                    ref.current.innerHTML = '';
                    ref.current.appendChild(icon);
                }
            }, [name]);

            return <i ref={ref} {...props}></i>;
        };

        const WellbeingMentorDemo = () => {
          const [students, setStudents] = useState([
            { id: 1, name: "Emma Thompson", grade: 10, section: "A", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 2, name: "Lucas Chen", grade: 10, section: "B", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 3, name: "Sophia Rodriguez", grade: 10, section: "A", program: "MYP", house: "Stormrider", group: 2, status: "synced" },
            { id: 4, name: "Noah Anderson", grade: 10, section: "A", program: "MYP", house: "Seadragon", group: 3, status: "synced", highlight: true },
            { id: 5, name: "Olivia Martin", grade: 10, section: "B", program: "MYP", house: "Seadragon", group: 3, status: "synced" },
            { id: 6, name: "Liam Johnson", grade: 10, section: "A", program: "MYP", house: "Seadragon", group: 4, status: "synced" },
            { id: 7, name: "Isabella White", grade: 10, section: "B", program: "Waldorf", house: "Wavecrest", group: 5, status: "synced" },
            { id: 8, name: "Mason Davis", grade: 10, section: "A", program: "MYP", house: "Wavecrest", group: 6, status: "synced" },
            { id: 9, name: "Ava Williams", grade: 9, section: "B", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 10, name: "Ethan Brown", grade: 9, section: "A", program: "MYP", house: "Stormrider", group: 2, status: "synced" },
            { id: 11, name: "Charlotte Garcia", grade: 9, section: "A", program: "MYP", house: "Stormrider", group: 2, status: "synced", note: "returning 24th Sept" },
            { id: 12, name: "James Taylor", grade: 9, section: "B", program: "MYP", house: "Seadragon", group: 3, status: "synced" },
            { id: 13, name: "Amelia Lee", grade: 9, section: "A", program: "Waldorf", house: "Seadragon", group: 4, status: "synced" },
            { id: 14, name: "Benjamin Moore", grade: 9, section: "B", program: "MYP", house: "Seadragon", group: 4, status: "synced", note: "8th Oct" },
            { id: 15, name: "Mia Wilson", grade: 9, section: "A", program: "MYP", house: "Wavecrest", group: 5, status: "synced" },
            { id: 16, name: "Alexander Harris", grade: 9, section: "B", program: "MYP", house: "Wavecrest", group: 6, status: "synced", highlight: true },
            { id: 17, name: "Harper Martinez", grade: 8, section: "A", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 18, name: "Daniel Robinson", grade: 8, section: "B", program: "MYP", house: "Stormrider", group: 2, status: "synced" },
            { id: 19, name: "Evelyn Clark", grade: 8, section: "A", program: "MYP", house: "Seadragon", group: 3, status: "synced" },
            { id: 20, name: "Michael Lewis", grade: 8, section: "B", program: "MYP", house: "Seadragon", group: 3, status: "synced", highlight: true },
            { id: 21, name: "Sofia Walker", grade: 8, section: "A", program: "Waldorf", house: "Seadragon", group: 4, status: "synced" },
            { id: 22, name: "David Hall", grade: 8, section: "B", program: "MYP", house: "Wavecrest", group: 5, status: "synced" },
            { id: 23, name: "Emily Young", grade: 8, section: "A", program: "MYP", house: "Wavecrest", group: 6, status: "synced" },
            { id: 24, name: "Henry Allen", grade: 7, section: "A", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 25, name: "Luna King", grade: 7, section: "B", program: "MYP", house: "Stormrider", group: 2, status: "synced" },
            { id: 26, name: "Owen Wright", grade: 7, section: "A", program: "MYP", house: "Seadragon", group: 3, status: "synced" },
            { id: 27, name: "Aria Scott", grade: 7, section: "B", program: "Waldorf", house: "Seadragon", group: 4, status: "synced" },
            { id: 28, name: "Leo Green", grade: 7, section: "A", program: "MYP", house: "Wavecrest", group: 5, status: "synced", note: "returning" },
            { id: 29, name: "Zoe Baker", grade: 7, section: "B", program: "MYP", house: "Wavecrest", group: 6, status: "synced" },
            { id: 30, name: "Jack Adams", grade: 6, section: "A", program: "MYP", house: "Stormrider", group: 1, status: "synced" },
            { id: 31, name: "Lily Nelson", grade: 6, section: "B", program: "MYP", house: "Stormrider", group: 2, status: "synced" },
            { id: 32, name: "Ryan Carter", grade: 6, section: "A", program: "MYP", house: "Seadragon", group: 3, status: "synced" },
            { id: 33, name: "Grace Mitchell", grade: 6, section: "B", program: "Waldorf", house: "Seadragon", group: 4, status: "synced" },
            { id: 34, name: "Nathan Perez", grade: 6, section: "A", program: "MYP", house: "Wavecrest", group: 5, status: "synced" },
            { id: 35, name: "Chloe Roberts", grade: 6, section: "B", program: "MYP", house: "Wavecrest", group: 6, status: "synced" },
            { id: 36, name: "Victoria Chen", grade: 12, section: "A", program: "DP", house: "Stormrider", group: 1, status: "synced" },
            { id: 37, name: "Marcus Johnson", grade: 12, section: "B", program: "DP", house: "Stormrider", group: 2, status: "synced" },
            { id: 38, name: "Sophia Williams", grade: 12, section: "A", program: "DP", house: "Seadragon", group: 3, status: "synced" },
            { id: 39, name: "Lucas Anderson", grade: 12, section: "B", program: "DP", house: "Seadragon", group: 4, status: "synced" },
            { id: 40, name: "Emma Rodriguez", grade: 12, section: "A", program: "DP", house: "Wavecrest", group: 5, status: "synced" },
            { id: 41, name: "Oliver Thompson", grade: 11, section: "B", program: "DP", house: "Stormrider", group: 1, status: "synced" },
            { id: 42, name: "Ava Martinez", grade: 11, section: "A", program: "DP", house: "Stormrider", group: 2, status: "synced" },
            { id: 43, name: "Noah Garcia", grade: 11, section: "B", program: "DP", house: "Seadragon", group: 3, status: "synced" },
            { id: 44, name: "Isabella Davis", grade: 11, section: "A", program: "DP", house: "Seadragon", group: 4, status: "synced", highlight: true },
            { id: 45, name: "Ethan Wilson", grade: 11, section: "B", program: "DP", house: "Wavecrest", group: 5, status: "synced" },
            { id: 46, name: "Mia Brown", grade: 11, section: "A", program: "DP", house: "Wavecrest", group: 6, status: "synced" },
            { id: 47, name: "Maya Zhang", grade: 9, section: "A", program: "MYP", house: "Unassigned", group: null, status: "new" },
            { id: 48, name: "Sebastian Kumar", grade: 11, section: "B", program: "DP", house: "Unassigned", group: null, status: "new" }
          ]);

          const [draggedStudent, setDraggedStudent] = useState(null);
          const [pendingChanges, setPendingChanges] = useState([]);
          const [isSyncing, setIsSyncing] = useState(false);
          const [selectedPrograms, setSelectedPrograms] = useState(["MYP", "DP", "Waldorf"]);
          const [selectedGrades, setSelectedGrades] = useState([6, 7, 8, 9, 10, 11, 12]);

          const houses = [
            {
              name: "Stormrider",
              groups: [
                { group: 1, tutor: "Ms. Roberts", firstName: "Kate", lastName: "Roberts", room: "Music Room" },
                { group: 2, tutor: "Mr. Johnson", firstName: "Mike", lastName: "Johnson", room: "Art1" }
              ]
            },
            {
              name: "Seadragon",
              groups: [
                { group: 3, tutor: "Mrs. Chen", firstName: "Linda", lastName: "Chen", room: "Science2" },
                { group: 4, tutor: "Mr. Martin", firstName: "Taylor", lastName: "Martin", room: "English1" }
              ]
            },
            {
              name: "Wavecrest",
              groups: [
                { group: 5, tutor: "Ms. Anderson", firstName: "Sarah", lastName: "Anderson", room: "Maths3" },
                { group: 6, tutor: "Mr. Thompson", firstName: "Peter", lastName: "Thompson", room: "History1" }
              ]
            }
          ];

          const allGrades = [12, 11, 10, 9, 8, 7, 6];
          const allPrograms = ["MYP", "DP", "Waldorf"];

          const gradeColors = {
            12: "bg-blue-100",
            11: "bg-blue-200",
            10: "bg-sky-100",
            9: "bg-sky-200",
            8: "bg-cyan-100",
            7: "bg-cyan-200",
            6: "bg-teal-100"
          };

          const programColors = {
            "MYP": "bg-sky-100 text-sky-800 border-sky-300",
            "DP": "bg-blue-100 text-blue-800 border-blue-300",
            "Waldorf": "bg-green-100 text-green-800 border-green-300"
          };

          const getYearLabel = (student) => {
            const programPrefix = student.program === "Waldorf" ? "W" : student.program;
            return `${programPrefix}${student.grade}${student.section || ''}`;
          };

          const getEmail = (firstName, lastName) => {
            return `${firstName.charAt(0).toLowerCase()}${lastName.toLowerCase()}@isl.cy`;
          };

          const toggleProgram = (program) => {
            setSelectedPrograms(prev =>
              prev.includes(program)
                ? prev.filter(p => p !== program)
                : [...prev, program]
            );
          };

          const toggleGrade = (grade) => {
            setSelectedGrades(prev =>
              prev.includes(grade)
                ? prev.filter(g => g !== grade)
                : [...prev, grade]
            );
          };

          const filteredStudents = students.filter(s => {
            const programMatch = selectedPrograms.includes(s.program);
            const gradeMatch = selectedGrades.includes(s.grade);
            return programMatch && gradeMatch;
          });

          const handleDragStart = (student) => {
            setDraggedStudent(student);
          };

          const handleDragOver = (e) => {
            e.preventDefault();
          };

          const handleDrop = (house, group) => {
            if (!draggedStudent) return;

            const oldHouse = draggedStudent.house;
            const oldGroup = draggedStudent.group;

            setStudents(students.map(s =>
              s.id === draggedStudent.id
                ? { ...s, house, group, status: "pending" }
                : s
            ));

            setPendingChanges(prev => [
              ...prev,
              {
                id: Date.now(),
                studentId: draggedStudent.id,
                studentName: draggedStudent.name,
                from: { house: oldHouse, group: oldGroup },
                to: { house, group },
                timestamp: new Date().toLocaleTimeString()
              }
            ]);

            setDraggedStudent(null);
          };

          const handleSync = async () => {
            setIsSyncing(true);

            await new Promise(resolve => setTimeout(resolve, 1500));

            setStudents(students.map(s =>
              s.status === "pending" ? { ...s, status: "synced" } : s
            ));

            setPendingChanges([]);
            setIsSyncing(false);
          };

          const getStudentCount = (group) => {
            return filteredStudents.filter(s => s.group === group).length;
          };

          const getTotalCount = () => {
            return filteredStudents.filter(s => s.house !== "Unassigned").length;
          };

          return (
            <div className="min-h-screen bg-white p-6">
              <div className="max-w-7xl mx-auto">
                {/* Header */}
                <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <Icon name="Users" className="w-8 h-8 text-orange-600" />
                      <div>
                        <h1 className="text-3xl font-bold text-gray-900">Wellbeing Mentor Tracker</h1>
                        <p className="text-sm text-gray-600">The Island Private School of Limassol - 2025-2026</p>
                      </div>
                    </div>
                    <div className="text-right">
                      <div className="text-sm text-gray-500">Last Sync</div>
                      <div className="text-lg font-semibold text-green-600 flex items-center justify-end gap-2">
                        <Icon name="CheckCircle" className="w-5 h-5" />
                        In Sync
                      </div>
                    </div>
                  </div>
                </div>

                {/* Pending Changes Banner */}
                {pendingChanges.length > 0 && (
                  <div className="bg-amber-50 border-l-4 border-amber-500 rounded-lg p-5 mb-6 shadow-sm">
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-3">
                          <Icon name="AlertCircle" className="w-5 h-5 text-amber-600" />
                          <h3 className="font-bold text-amber-900">Pending Changes ({pendingChanges.length})</h3>
                        </div>
                        <div className="space-y-1.5 max-h-32 overflow-y-auto">
                          {pendingChanges.map(change => (
                            <div key={change.id} className="text-sm text-amber-800">
                              <strong>{change.studentName}</strong> → {change.to.house} (Group {change.to.group})
                            </div>
                          ))}
                        </div>
                      </div>
                      <button
                        onClick={handleSync}
                        disabled={isSyncing}
                        className={`ml-4 px-6 py-3 rounded-lg font-semibold text-white shadow-md transition-all flex items-center gap-2 ${
                          isSyncing
                            ? "bg-gray-400 cursor-not-allowed"
                            : "bg-orange-600 hover:bg-orange-700"
                        }`}
                      >
                        <Icon name="RefreshCw" className={`w-5 h-5 ${isSyncing ? 'animate-spin' : ''}`} />
                        {isSyncing ? "Syncing..." : "Sync to ManageBac"}
                      </button>
                    </div>
                  </div>
                )}

                {/* Filters and Quick Guide */}
                <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6">
                  <div className="flex items-start gap-8">
                    {/* Filters */}
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-3">
                        <Icon name="Filter" className="w-4 h-4 text-orange-600" />
                        <h3 className="font-bold text-gray-900">Filters</h3>
                        <span className="text-sm text-gray-600">({getTotalCount()} students)</span>
                      </div>

                      <div className="grid grid-cols-2 gap-4">
                        {/* Programme Filter */}
                        <div>
                          <label className="block text-xs font-semibold text-gray-700 mb-2">Programme</label>
                          <div className="flex flex-wrap gap-1.5">
                            {allPrograms.map(prog => (
                              <button
                                key={prog}
                                onClick={() => toggleProgram(prog)}
                                className={`px-2.5 py-1 rounded text-xs font-medium transition-all ${
                                  selectedPrograms.includes(prog)
                                    ? "bg-orange-600 text-white shadow-sm"
                                    : "bg-gray-100 text-gray-600 hover:bg-gray-200"
                                }`}
                              >
                                {prog}
                              </button>
                            ))}
                          </div>
                        </div>

                        {/* Grade Filter */}
                        <div>
                          <label className="block text-xs font-semibold text-gray-700 mb-2">Grades</label>
                          <div className="flex flex-wrap gap-1.5">
                            {allGrades.map(grade => (
                              <button
                                key={grade}
                                onClick={() => toggleGrade(grade)}
                                className={`px-2.5 py-1 rounded text-xs font-medium transition-all ${
                                  selectedGrades.includes(grade)
                                    ? "bg-orange-600 text-white shadow-sm"
                                    : "bg-gray-100 text-gray-600 hover:bg-gray-200"
                                }`}
                              >
                                {grade}
                              </button>
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Quick Guide */}
                    <div className="w-80 bg-orange-50 rounded-lg border border-orange-200 p-3">
                      <div className="flex items-center gap-2 mb-2">
                        <Icon name="BookOpen" className="w-4 h-4 text-orange-700" />
                        <h3 className="font-bold text-orange-900 text-sm">Quick Guide</h3>
                      </div>
                      <div className="space-y-1 text-xs text-orange-900">
                        <div>• <strong>Multi-select</strong> programmes and grades to filter</div>
                        <div>• <strong>Drag students</strong> between houses to reassign</div>
                        <div>• <strong>Click Sync</strong> to apply changes to ManageBac</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Matrix */}
                <div className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                  {/* Header - House Level */}
                  <div className="grid grid-cols-7 border-b-2 border-gray-300 bg-gray-50">
                    <div className="p-4 font-bold text-gray-800 border-r border-gray-300">Grade</div>
                    {houses.map(house => (
                      <div key={house.name} className="col-span-2 text-center border-r border-gray-300 last:border-r-0">
                        <div className="font-bold text-gray-900 text-lg py-3 border-b border-gray-200 bg-orange-50">{house.name}</div>
                        <div className="grid grid-cols-2">
                          {house.groups.map(g => (
                            <div key={g.group} className="p-2 border-r border-gray-200 last:border-r-0">
                              <div className="text-2xl font-bold text-orange-600">{g.group}</div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* Grade Rows */}
                  {allGrades.map(grade => {
                    const hasStudents = filteredStudents.some(s => s.grade === grade && s.house !== "Unassigned");
                    if (!hasStudents) return null;

                    return (
                      <div key={grade} className={`grid grid-cols-7 border-b border-gray-200 ${gradeColors[grade]}`}>
                        {/* Grade Label */}
                        <div className="p-4 font-bold text-gray-800 border-r border-gray-300 flex items-center justify-center text-2xl">
                          {grade}
                        </div>

                        {/* House Group Columns */}
                        {houses.map(house => (
                          <React.Fragment key={house.name}>
                            {house.groups.map(g => {
                              const groupStudents = filteredStudents.filter(s =>
                                s.grade === grade && s.house === house.name && s.group === g.group
                              );

                              return (
                                <div
                                  key={`${grade}-${house.name}-${g.group}`}
                                  className="p-2 border-r border-gray-200 last:border-r-0 min-h-32"
                                  onDragOver={handleDragOver}
                                  onDrop={() => handleDrop(house.name, g.group)}
                                >
                                  <div className="space-y-1.5">
                                    {groupStudents.map(student => (
                                      <div
                                        key={student.id}
                                        draggable
                                        onDragStart={() => handleDragStart(student)}
                                        className={`bg-white border rounded px-2.5 py-2 cursor-move hover:shadow-md transition-all group ${
                                          student.status === "pending"
                                            ? 'border-amber-400 bg-amber-50'
                                            : student.highlight
                                              ? 'border-orange-400 bg-orange-50'
                                              : 'border-gray-300 hover:border-orange-400'
                                        }`}
                                      >
                                        <div className="flex items-start gap-1.5">
                                          <Icon name="GripVertical" className="w-3.5 h-3.5 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 mt-0.5" />
                                          <div className="flex-1 min-w-0">
                                            <div className="text-sm font-semibold text-gray-900 truncate">{student.name}</div>
                                            {student.note && (
                                              <div className="text-xs text-gray-600 italic mt-0.5">{student.note}</div>
                                            )}
                                            <div className="mt-1">
                                              <span className={`inline-block text-xs px-2 py-0.5 rounded font-semibold border ${programColors[student.program]}`}>
                                                {getYearLabel(student)}
                                              </span>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    ))}
                                  </div>
                                </div>
                              );
                            })}
                          </React.Fragment>
                        ))}
                      </div>
                    );
                  })}

                  {/* Counts Row */}
                  <div className="grid grid-cols-7 border-b-2 border-gray-300 bg-gray-100">
                    <div className="p-3 font-semibold text-gray-700 border-r border-gray-300 flex items-center">
                      <Icon name="TrendingUp" className="w-4 h-4 mr-2" />
                      Total
                    </div>
                    {houses.map(house => (
                      <React.Fragment key={house.name}>
                        {house.groups.map(g => {
                          const count = getStudentCount(g.group);
                          return (
                            <div key={`count-${g.group}`} className="p-3 text-center border-r border-gray-200 last:border-r-0">
                              <div className="text-xl font-bold text-orange-600">{count}</div>
                            </div>
                          );
                        })}
                      </React.Fragment>
                    ))}
                  </div>

                  {/* Tutor Info Rows */}
                  <div className="grid grid-cols-7 bg-white border-b border-gray-200">
                    <div className="p-2.5 font-semibold text-gray-600 text-sm border-r border-gray-300">Tutor</div>
                    {houses.map(house => (
                      <React.Fragment key={house.name}>
                        {house.groups.map(g => (
                          <div key={`tutor-${g.group}`} className="p-2.5 text-center text-sm font-medium text-gray-900 border-r border-gray-200 last:border-r-0">
                            {g.tutor}
                          </div>
                        ))}
                      </React.Fragment>
                    ))}
                  </div>

                  <div className="grid grid-cols-7 bg-white border-b border-gray-200">
                    <div className="p-2.5 font-semibold text-gray-600 text-sm border-r border-gray-300">Email</div>
                    {houses.map(house => (
                      <React.Fragment key={house.name}>
                        {house.groups.map(g => (
                          <div key={`email-${g.group}`} className="p-2.5 text-center text-xs border-r border-gray-200 last:border-r-0">
                            <a
                              href={`mailto:${getEmail(g.firstName, g.lastName)}`}
                              className="text-orange-600 hover:text-orange-700 hover:underline"
                            >
                              {getEmail(g.firstName, g.lastName)}
                            </a>
                          </div>
                        ))}
                      </React.Fragment>
                    ))}
                  </div>

                  <div className="grid grid-cols-7 bg-gray-50">
                    <div className="p-2.5 font-semibold text-gray-600 text-sm border-r border-gray-300">Room</div>
                    {houses.map(house => (
                      <React.Fragment key={house.name}>
                        {house.groups.map(g => (
                          <div key={`room-${g.group}`} className="p-2.5 text-center text-sm text-gray-700 border-r border-gray-200 last:border-r-0">
                            {g.room}
                          </div>
                        ))}
                      </React.Fragment>
                    ))}
                  </div>

                  {/* Unassigned Section */}
                  {filteredStudents.filter(s => s.house === "Unassigned").length > 0 && (
                    <div className="border-t-4 border-orange-400 bg-orange-50">
                      <div className="p-5">
                        <h3 className="font-bold text-gray-900 mb-4 flex items-center gap-2 text-lg">
                          <Icon name="AlertCircle" className="w-6 h-6 text-orange-600" />
                          New Students - Awaiting Assignment
                        </h3>
                        <div className="grid grid-cols-6 gap-3">
                          {filteredStudents.filter(s => s.house === "Unassigned").map(student => (
                            <div
                              key={student.id}
                              draggable
                              onDragStart={() => handleDragStart(student)}
                              className="bg-white border-2 border-orange-400 rounded-lg px-3 py-3 cursor-move hover:shadow-lg hover:border-orange-500 transition-all"
                            >
                              <div className="text-sm font-bold text-gray-900">{student.name}</div>
                              {student.note && (
                                <div className="text-xs text-gray-600 italic mt-1">{student.note}</div>
                              )}
                              <div className="mt-2">
                                <span className={`inline-block text-xs px-2 py-0.5 rounded font-semibold border ${programColors[student.program]}`}>
                                  {getYearLabel(student)}
                                </span>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {/* Legend */}
                <div className="mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                  <h3 className="font-bold text-gray-900 mb-4 text-lg">Legend</h3>

                  <div className="grid md:grid-cols-3 gap-6">
                    {/* Status Indicators */}
                    <div>
                      <h4 className="text-sm font-semibold text-gray-700 mb-3">Status</h4>
                      <div className="space-y-2">
                        <div className="flex items-center gap-2">
                          <div className="w-6 h-6 bg-white border-2 border-gray-300 rounded"></div>
                          <span className="text-sm text-gray-700">Synced</span>
                        </div>
                        <div className="flex items-center gap-2">
                          <div className="w-6 h-6 bg-amber-50 border-2 border-amber-400 rounded"></div>
                          <span className="text-sm text-gray-700">Pending sync</span>
                        </div>
                        <div className="flex items-center gap-2">
                          <div className="w-6 h-6 bg-orange-50 border-2 border-orange-400 rounded"></div>
                          <span className="text-sm text-gray-700">Highlighted</span>
                        </div>
                      </div>
                    </div>

                    {/* Programme Colors */}
                    <div>
                      <h4 className="text-sm font-semibold text-gray-700 mb-3">Programmes</h4>
                      <div className="space-y-2">
                        <div className="flex items-center gap-2">
                          <span className="text-xs px-2 py-0.5 rounded bg-sky-100 text-sky-800 font-semibold border border-sky-300">MYP10A</span>
                          <span className="text-sm text-gray-700">MYP (light blue)</span>
                        </div>
                        <div className="flex items-center gap-2">
                          <span className="text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800 font-semibold border border-blue-300">DP11B</span>
                          <span className="text-sm text-gray-700">DP (dark blue)</span>
                        </div>
                        <div className="flex items-center gap-2">
                          <span className="text-xs px-2 py-0.5 rounded bg-green-100 text-green-800 font-semibold border border-green-300">W7A</span>
                          <span className="text-sm text-gray-700">Waldorf (green)</span>
                        </div>
                      </div>
                    </div>

                    {/* Grade Colors */}
                    <div>
                      <h4 className="text-sm font-semibold text-gray-700 mb-3">Grade Backgrounds</h4>
                      <div className="grid grid-cols-2 gap-2">
                        {allGrades.map(grade => (
                          <div key={grade} className="flex items-center gap-2">
                            <div className={`w-6 h-6 ${gradeColors[grade]} border border-gray-300 rounded`}></div>
                            <span className="text-sm text-gray-700">Gr. {grade}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WellbeingMentorDemo />);
    </script>
</body>
</html>
